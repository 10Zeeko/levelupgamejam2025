[gd_scene load_steps=4 format=3 uid="uid://gyxfuheccwcr"]

[sub_resource type="GDScript" id="GDScript_rtxln"]
resource_name = "LevelTimer"
script/source = "extends Node2D

@onready var timer: Timer = $TextureProgressBar/Timer
@export var timer_time: float
@onready var restart_timer: Timer = $RestartTimer
@onready var texture_progress_bar: TextureProgressBar = $TextureProgressBar

func start_timer():
	decrease_timer()
	timer.wait_time = timer_time
	timer.start()

func decrease_timer():
	var tw = create_tween()
	tw.tween_property(
		texture_progress_bar,
		\"value\",
		0.0,
		timer_time
	)

func _on_timer_timeout() -> void:
	restart_timer.start()
	Globals.transition_fade_in()
	if not(Globals.level_completed):
		Globals.kill_player()
		Globals.shake_for_time($\"../..\", 50.0, 0.1)


func _on_restart_timer_timeout() -> void:
	Globals.change_level()
"

[sub_resource type="Gradient" id="Gradient_hpg2j"]
colors = PackedColorArray(0.52549, 0.0627451, 0.054902, 1, 0.87451, 0.109804, 0.0980392, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_bgghe"]
gradient = SubResource("Gradient_hpg2j")
width = 120
height = 232
fill_to = Vector2(0, 1)

[node name="LevelTimer" type="Node2D"]
script = SubResource("GDScript_rtxln")
timer_time = 10.0

[node name="TextureProgressBar" type="TextureProgressBar" parent="."]
offset_right = 32.0
offset_bottom = 200.0
max_value = 200.0
value = 200.0
fill_mode = 3
texture_progress = SubResource("GradientTexture2D_bgghe")

[node name="Timer" type="Timer" parent="TextureProgressBar"]
one_shot = true

[connection signal="timeout" from="TextureProgressBar/Timer" to="." method="_on_timer_timeout"]
